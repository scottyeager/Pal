# Abbreviations

In `fish`, abbreviations are a native feature that essentially enables arbitrary text substitutions during command input, triggered by the space and enter keys. There is a plugin that offers similar functionality for `zsh` called [zsh-abbr](https://github.com/olets/zsh-abbr), but `pal` doesn't depend on this plugin. Abbreviations serve a similar function to aliases, with the main difference being that abbreviations expand into their full form.

For `pal` the abbreviation feature is used to expand command suggestions generated by AI. A configurable prefix is used, followed by a number:

```sh
$ pal list files
ls
find .
dir

$ pal1 # Expands to `ls`
$ pal3 # Expands to `dir`
# Multiple lines can also be expanded together, such as with pal123
```

Note for zsh users: type the abbreviation (e.g. `pal1`) and press Space to expand. Press Enter afterwards to execute the expanded command.

This eliminates the need to copy and paste command suggestions. The abbreviations will always dynamically expand into the commands suggested by the last bare `pal` command or the equivalent `/cmd` command.

The stored commands that will expand when using the abbreviations can be printed with `/show`:

```sh
pal /show
```

## Enabling abbreviations

If you followed the quickstart instructions, then you should already have abbreviations enabled. Look for a line in your `config.fish` or `.zshrc` file with a note about this if you're not sure.

Otherwise, here are the instructions for enabling abbreviations. These procedures cause a small amount of code to be run at the start of each new shell session. This is a normal way to extend shells and it happens very fast. You shouldn't notice any additional delay when starting a new shell session.

### fish

You can enable both abbreviations and autocompletions for `fish` like this:

```sh
pal --fish-config >> ~/.config/fish/config.fish
```

To activate just abbreviations add the following to your `~/.config/fish/config.fish`:

```sh
pal --fish-abbr | source
```

Bring this change into open shell sessions by sourcing your config file again:

```sh
source ~/.config/fish/config.fish
```

### zsh

You can enable both abbreviations and autocompletions for `zsh` like this:

```sh
pal --zsh-config >> ~/.zshrc
```

To activate just abbreviations add the following to your `~/.zshrc`:

```sh
pal --zsh-abbr | source
```

Bring this change into open shell sessions by sourcing your config file again:

```sh
source ~/.zshrc
```

#### Using abbreviations in zsh

- Type `pal1` then press Space to expand to the first suggestion. Press Enter to run it.
- Use `pal2`, `pal3`, etc. For multiple lines, `pal123` expands the first three suggestions.
- Show the stored suggestions at any time with:
  ```sh
  pal /show
  ```

#### Troubleshooting (zsh)

- Enable for the current shell immediately:
  ```sh
  source <(pal --zsh)
  ```
- Verify Space is bound to the expansion widget:
  ```sh
  bindkey ' ' | grep pal-expand-abbr
  ```
  If there’s no output, re-run the `source <(pal --zsh)` command above.

#### Paths

The file that stores suggestions (used by `pal1`, `pal2`, …):

- macOS: `~/Library/Application Support/pal_helper/expansions.txt`
- Linux: `~/.local/share/pal_helper/expansions.txt`

## Disabling abbreviations

To disable the abbreviation feature, just remove the line from your shell config file. No permanent changes have been made to your shell, but this change will also only apply to new shells.

## Skip expansion

To skip expansion of abbreviations, press `Ctrl + Space` instead of `Space`. This is useful when you want to type a space character without expanding an abbreviation.

## Pal and zsh-abbr

If you're using `zsh-abbr`, you might be wondering how `pal` interacts with it. What's designed to happen is that `pal` expands any valid combinations of prefix plus digits, and then it defers to `zsh-abbr` if a match isn't found. This should work seamlessly, but if you notice any problems, please open an [issue](https://github.com/pal/pal/issues).

## The prefix0 expansion

In addition to command suggestions, `pal` also has a "system" expansion that's reserved for instances where `pal` wants to suggest a command to you. This works basically like any other expansion and the contents of the expansion will also show when you run `pal /show`.
